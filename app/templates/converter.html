{% extends "base.html" %}

{% block scripts %} 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<script>
   
    function convert(cur_from, cur_to, value, result_value) {
        $.post('/convert', {
            cur_from: document.getElementById(cur_from).value,
            cur_to: document.getElementById(cur_to).value,
            value: document.getElementById(value).value
        }).done(function(response) {
            document.getElementById(result_value).value = response['text']
        }).fail(function() {
            document.getElementById(result_value).value = "При конвертации произошла ошибка";
        });
    }
</script>

<script>
    function swap_cur(cur_from, cur_to, value, result_value) {
        let tmp = document.getElementById(cur_from).value
        document.getElementById(cur_from).value = document.getElementById(cur_to).value
        document.getElementById(cur_to).value = tmp

        tmp = document.getElementById(value).value
        document.getElementById(value).value = document.getElementById(result_value).value
        document.getElementById(result_value).value = tmp
    }
</script>

{% endblock %}


{% block app_content %} 



    <h1>Конвертер валют</h1>
    <div class="form-inline">
        <select class="form-control" id="from_currency" onchange="convert('from_currency','to_currency','amount','result')">
            <option value="USD">Доллар</option>
            <option value="EUR">Евро</option>
            <option value="GBP">Фунт</option>
            <option value="RUB">Рубль</option>
        </select>
        <input type="number" class="form-control" id="amount" value ="0" step="0.1" oninput="convert('from_currency','to_currency','amount','result')">
    </div>

    <div class="form-inline">
        <select class="form-control" id="to_currency" onchange="convert('from_currency','to_currency','amount','result')">
            <option value="USD">Доллар</option>
            <option selected ="selected" value="EUR">Евро</option>
            <option value="GBP">Фунт</option>
            <option value="RUB">Рубль</option>
        </select>
    
        <input type="number" class="form-control" id="result" value="0" readonly>
    </div>
    
    <button type="button" class="btn btn-primary" id="swap_currencies" onclick="swap_cur('from_currency','to_currency','amount','result')">
        <i class="fas fa-exchange-alt">Сменить</i>
    </button>

{% endblock %}